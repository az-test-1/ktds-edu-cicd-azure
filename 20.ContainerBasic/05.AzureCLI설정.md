

# 1. 개요

Azure ClI 설치 및 기타 환경 설정을 가이드한다.





# 2. Azure CLI 설치 및 로그인

## 1) Azure CLI 설치

- Azure CLI가 설치되어 있지 않다면 [Azure CLI 설치 가이드](https://docs.microsoft.com/ko-kr/cli/azure/install-azure-cli)에서 설치한다.

```sh

# ubuntu 기준
$ curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash

```



## 2) Azure 로그인

터미널에서 다음 명령어를 입력하여 Azure에 로그인한다.

```sh
  
$ az login --use-device-code

To sign in, use a web browser to open the page https://microsoft.com/devicelogin and enter the code SXH2GWN5M to authenticate.

Retrieving tenants and subscriptions for the selection...
The following tenants don't contain accessible subscriptions. Use `az login --allow-no-subscriptions` to have tenant level access.
354fc7cf-eb06-4937-9360-8ac89af5166c 'ktds'

[Tenant and subscription selection]

No     Subscription name    Subscription ID                       Tenant
-----  -------------------  ------------------------------------  -------------
[1] *  *********            f67329b1-68bf-4980-8f0e-1de9441ae4c0  기본 디렉터리
[2]    ktds-edu-sub         a7360040-8c13-43d4-9f8d-16c77c517a5b  ktdsedu

The default is marked with an *; the default tenant is '기본 디렉터리' and subscription is 'Dio 통합 구독' (f67329b1-68bf-4980-8f0e-1de9441ae4c0).

Select a subscription and tenant (Type a number or Enter for no changes): 2

Tenant: ktdsedu
Subscription: ktds-edu-sub (a7360040-8c13-43d4-9f8d-16c77c517a5b)

[Announcements]
With the new Azure CLI login experience, you can select the subscription you want to use more easily. Learn more about it and its configuration at https://go.microsoft.com/fwlink/?linkid=2271236

If you encounter any problem, please open an issue at https://aka.ms/azclibug

[Warning] The login output has been updated. Please be aware that it no longer displays the full list of available subscriptions by default.

```



* 확인

```sh
# 구독 확인
$ az account list -o table
Name           CloudName    SubscriptionId                        TenantId                              State    IsDefault
-------------  -----------  ------------------------------------  ------------------------------------  -------  -----------
ktds-edu-sub   AzureCloud   a7360040-8c13-43d4-9f8d-16c77c517a5b  f6937904-9ad3-41ad-93de-cee02acb83d8  Enabled  True


# 리소스 그룹 확인
$ az group list -o table
Name               Location      Status
-----------------  ------------  ---------
ktdsedu-rg         koreacentral  Succeeded
NetworkWatcherRG   koreacentral  Succeeded
ktdsedu-aks-mc-rg  koreacentral  Succeeded
ktdseduvm-rg       koreacentral  Succeeded


```



# 3. AKS 연결




## 1) kubectl 설치

```sh

$ sudo az aks install-cli

# 확인
$ kubectl version --client
Client Version: v1.31.0
Kustomize Version: v5.4.2

```



## 2) AKS 연결

```sh

$ az aks list -o table
Name         Location      ResourceGroup    KubernetesVersion    CurrentKubernetesVersion    ProvisioningState    Fqdn
-----------  ------------  ---------------  -------------------  --------------------------  -------------------  ----------------------------------------------------------------
ktdsedu-aks  koreacentral  ktdsedu-rg       1.29                 1.29.8                      Succeeded            ktdsedu-ak-ktdsedu-rg-a73600-hqsx8ki7.hcp.koreacentral.azmk8s.io



# 연결
export RG_NAME=ktdsedu-rg
export AKS_CLUSTER_NAME=ktdsedu-aks

# Credentials 정보 확인
$ az aks get-credentials \
    --name $AKS_CLUSTER_NAME \
    --resource-group $RG_NAME

Merged "ktdsedu-aks" as current context in /home/edu/.kube/config



# 확인
$ kubectl config view
...

```



## 3) use-context

```sh

# get-context
$ kubectl config get-contexts
CURRENT   NAME          CLUSTER       AUTHINFO                             NAMESPACE
*         ktdsedu-aks   ktdsedu-aks   clusterUser_ktdsedu-rg_ktdsedu-aks


# 여러개의 context가 존재할경우 택일할 수 있다.

# use-context
$ kubectl config use-context ktdsedu-aks
Switched to context "ktdsedu-aks".


# kubectl 명령 확인
$ kubectl get ns
$ kubectl get pod -A

```





