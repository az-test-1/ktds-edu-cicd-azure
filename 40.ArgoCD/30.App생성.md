

# Project 생성



```sh

$ cat <<EOF | kubectl -n argocd-system apply -f -
apiVersion: argoproj.io/v1alpha1
kind: AppProject
metadata:
  name: pedu00
  namespace: argocd-system
spec:
  description: "edu00 project"
  sourceRepos:
    - https://github.com/rohansong/SampleJava.git
  destinations:
    - namespace: edu00
      server: https://kubernetes.default.svc
    - namespace: edu00-dev
      server: https://kubernetes.default.svc
    - namespace: edu00-prd
      server: https://kubernetes.default.svc
  clusterResourceWhitelist:
    - group: "*"
      kind: "*"
EOF


```





# manifest 수정



```


apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  labels:
    app.kubernetes.io/instance: edu01-samplejava-dev
  name: samplejava-ingress
  namespace: edu00-dev
spec:
  ingressClassName: nginx
  rules:
    - host: samplejava.edu00-dev.20.249.203.31.nip.io
      http:
        paths:
          - backend:
              service:
                name: samplejava-svc
                port:
                  number: 80
            path: /
            pathType: Prefix
            
            
```













# ArgoCD App 생성

ArgoCD 애플리케이션을 생성하려면 선언적 구성 파일을 작성하고 이를 적용한다.



## App 구성 파일 확인

다음은 애플리케이션 구성 파일의 예시입니다.

```


$ cat <<EOF | kubectl -n argocd-system apply -f -
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: samplejava-dev
  namespace: argocd-system
spec:
  project: default
  source:
    repoURL: 'https://github.com/rohansong/SampleJava.git'
    targetRevision: main
    path: manifests/overlays/dev
  destination:
    name: in-cluster
    namespace: edu00-dev
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
EOF


$ cat <<EOF | kubectl -n argocd-system apply -f -
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: edu01-samplejava-dev
  namespace: argocd-system
spec:
  project: pedu01
  source:
    repoURL: 'https://github.com/rohansong/SampleJava.git'
    targetRevision: main
    path: manifests/overlays/dev
  destination:
    name: in-cluster
    namespace: edu01-dev
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
EOF


```

## 애플리케이션 적용

작성한 애플리케이션 구성 파일을 Kubernetes 클러스터에 적용합니다.

```
kubectl apply -f my-app.yaml
```

# 요약

1. Git 리포지토리 자격 증명 관리